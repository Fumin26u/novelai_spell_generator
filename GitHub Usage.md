# GitHub Usage (2022/11/21)

## 概要

NovelAI Spell Generatorの規模が予想よりも大きくなっているので、データの混同を避けるために設ける。

「中規模」「個人開発」であることを念頭に規定するが、より規模が大きくなる場合は改変する場合もある。

## ブランチの切り方

- mainブランチから直接切るものと、そこから切るものの**3段ツリー形式**とし、**それ以上のツリーは作らない**。
    - ここでは便宜上mainブランチを「親」、直接切ったブランチを「子」、子から切ったブランチを「孫」と呼ぶ。
- バージョンログの更新、コメントアウトやデバッグログの削除など簡潔で機能面に影響を及ぼさない変更はmainで行っても良い。

### 子ブランチ

- 命名規則は、[開発内容]_[機能名] とする。**この他の名前を付けたい場合、代わりに孫ブランチを切って命名する**。
- [開発内容] に該当する項目
    - dev: developの略。新機能の開発に使用。
    - refactoring: リファクタリング。画面上の機能は変更せず内部コードを修正する時に使用。
    - bugfix: バグ修正をする際に使用。
    - others: モジュールインストール等上記に関係ない開発で時間がかかるような場合に使用する。できるだけ使わないことが望ましい。
- [機能名] に該当する項目
    - generator: ジェネレーター (トップ) ページ。ヘッダーとDB登録モーダルの改修もここで行う。
    - saver: セーバー (プリセット管理) ページ。
    - register: セーバーの中でもDB登録・更新・削除を担うページ (現在の*commands.php*)を指すが、SPA化でセーバートップページに統合するので恐らく利用しなくなる。
    - master: マスタ (プロンプト・ジャンル管理) ページ。
- 例外：
    - version: 新バージョンを本公開サーバーにアップロードした際に、その時点でのデータをアーカイブするために使用。
    - **該当ブランチでの更新は一切しないこと**。
    - 命名規則は、version_[数値] とする。(数値はn.n.n)

### 孫ブランチ

- 特定の機能部分で時間を要する(2人日以上掛かる程度)場合に子ブランチから切る。
- 基本的には子ブランチで作業すること。
- 命名規則は特に無いが、[やりたい事(動詞)]_[機能名] の形を取るのが望ましい。

## Pull Requestについて

- **1機能単位で完成**した際、テストサーバーにアップロードして**動作確認が完了した後**に出す。
    - 機能の規模は問わないが、上記の通り機能追加に関連した場所の動作確認は必ずする事。
- 小規模の機能追加などで、タイトルだけで説明ができるものは特に詳細を書く必要は無い。
- 大規模な機能追加の場合はどこに何を追加したのか詳細欄に記入する。
- リファクタリング・バグ修正の場合は**必ずどこをどのように修正したのか記入する**。(今後の活用の為のメモとして利用)

## Commitについて

- 1時間に1~2回以上を目安に定期的にCommitを行うこと。
- 機能が完成している必要は無いので、「区切り良いな」と思ったタイミングで行う、程度の認識でok
- タイトルには何をどうしたかを簡潔に書くのが望ましい。
    - 動作検証など同じ場所の修正を何度もする場合はこの限りではない。数字などで回数をつけておくなどで良い
- コメントは特に書く必要は無いが、プルリク同様覚えておいた方が良いことなどはメモ書き程度に記入する。
    - 特に規定は無いので雑に戯言を書いても問題無し

## 既存ブランチの整理

- 上記命名規則に従ってRenameすること。
- 半数程度のブランチは色んな場所の変更が混ざってたりする。
    - 特に更新から2週間以上経っているものは使わないと思われるので消去。必要になったらまた作ればよい。
- バージョンについてはほとんど残していないので既存のもののみ対応する。